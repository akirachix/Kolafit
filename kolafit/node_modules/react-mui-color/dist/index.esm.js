import e,{useState as t,useMemo as n,useCallback as r}from"react";import{Stack as l,Box as o,Button as a,Paper as i,rgbToHex as s,hslToRgb as u,Grid as d,TextField as c}from"@mui/material";import{grey as h,red as m,pink as p,purple as f,indigo as g,blue as x,cyan as v,teal as b,green as C,lime as w,amber as E,orange as $}from"@mui/material/colors";import{hexToRgb as M,rgbToHex as k,hslToRgb as y}from"@mui/system";const R=["#000000",h[900],h[700],h[500],h[400],h[300],h[100],"#ffffff",m[700],m[500],m[300],m[100],p[700],p[500],p[300],p[100],f[700],f[500],f[300],f[100],g[700],g[500],g[300],g[100],x[700],x[500],x[300],x[100],v[700],v[500],v[300],v[100],b[700],b[500],b[300],b[100],C[700],C[500],C[300],C[100],w[700],w[500],w[300],w[100],E[700],E[500],E[300],E[100],$[700],$[500],$[300],$[100]];function N(e){const{s:t,v:n}=function(e){var{r:t,g:n,b:r}=W(e);t/=255,n/=255,r/=255;const l=Math.max(t,n,r),o=l-Math.min(t,n,r);return{h:o?60*(l===t?(n-r)/o+(n<r?6:0):l===n?2+(r-t)/o:4+(t-n)/o):0,s:l?o/l*100:0,v:100*l}}(e.rgb.value);return[t,100-n]}function S(e){var{r:t,g:n,b:r}=W(e);t/=255,n/=255,r/=255;const l=Math.min(t,n,r),o=Math.max(t,n,r),a=o-l;var i=0,s=(o+l)/2;return i=0===a?0:o===t?(n-r)/a%6:o==n?(r-t)/a+2:(t-n)/a+4,(i=Math.round(60*i))<0&&(i+=360),`hsl(${i}, ${+(100*(0==a?0:a/(1-Math.abs(2*s-1)))).toFixed(1)}%, ${s=+(100*s).toFixed(1)}%)`}function W(e){var t,n,r;const l=/rgb\((\d+),\s?(\d+),\s?(\d+)\)/i.exec(e);return{value:e,r:Number(null!==(t=null==l?void 0:l[1])&&void 0!==t?t:0),g:Number(null!==(n=null==l?void 0:l[2])&&void 0!==n?n:0),b:Number(null!==(r=null==l?void 0:l[3])&&void 0!==r?r:0)}}function z(e){var t,n,r;const l=/hsl\((\d+),\s?([\d.]+)%,\s?([\d.]+)%\)/i.exec(e);return{value:e,h:Number(null!==(t=null==l?void 0:l[1])&&void 0!==t?t:0),s:Number(null!==(n=null==l?void 0:l[2])&&void 0!==n?n:0),l:Number(null!==(r=null==l?void 0:l[3])&&void 0!==r?r:0)}}function H(e,t,n){return n?Math.min(e,t)===e?t:Math.max(e,n)===e?n:e:Math.max(e,t)===t?e:t}const P=t=>{var n,r;const{parsedColor:a,satCoords:i,hueCoords:s,onSaturationChange:u,onHueChange:d}=t;return e.createElement(l,{id:"cp-free-root",spacing:1,sx:{mb:2,width:"455px",maxWidth:"100%"}},e.createElement(o,{id:"cp-saturation",sx:{width:"100%",height:"142px",backgroundColor:`hsl(${a.hsl.h}, 100%, 50%)`,backgroundImage:"linear-gradient(transparent,black),linear-gradient(to right,white,transparent)",borderRadius:"4px",position:"relative",cursor:"crosshair"},onClick:u},e.createElement(o,{id:"cp-saturation-indicator",sx:{width:"15px",height:"15px",border:"2px solid #ffffff",borderRadius:"50%",backgroundColor:a.hex.value,transform:"translate(-7.5px, -7.5px)",position:"absolute",left:(null!==(n=null==i?void 0:i[0])&&void 0!==n?n:0)+"%",top:(null!==(r=null==i?void 0:i[1])&&void 0!==r?r:0)+"%"}})),e.createElement(o,{id:"cp-hue",sx:{width:"100%",height:"12px",backgroundImage:"linear-gradient(to right,#ff0000,#ffff00,#00ff00,#00ffff,#0000ff,#ff00ff,#ff0000)",borderRadius:"999px",position:"relative",cursor:"crosshair"},onClick:d},e.createElement(o,{id:"cp-hue-indicator",sx:{width:"15px",height:"15px",border:"2px solid #ffffff",borderRadius:"50%",backgroundColor:a.hex.value,transform:"translate(-7.5px, -2px)",position:"absolute",left:(null!=s?s:0)+"%"}})))},T=t=>{const{parsedColor:n,colors:r,onSelect:l}=t;return e.createElement(o,{id:"cp-predefined-root",sx:{mb:2,display:"flex",flexDirection:"column",flexWrap:"wrap",height:"142px",width:"455px",maxWidth:"100%",overflow:"auto",scrollbarWidth:"none",msOverflowStyle:"none","&::-webkit-scrollbar":{display:"none"}}},r.map((t=>e.createElement(a,{className:"cp-predefined-button",key:t,onClick:e=>l(t,!1),sx:{minWidth:"auto",p:"5px",border:e=>t===(null==n?void 0:n.hex.value)?"1px solid "+e.palette.primary.main:"none"}},e.createElement(i,{className:"cp-predefined-color",elevation:1,sx:{width:"25px",height:"25px",borderRadius:"50%",background:t}})))))},j=l=>{const{color:a,initialColor:h,colors:m,onChange:p,variant:f,sx:g}=l,[x,v]=t(h||"#181d23"),b=n((()=>function(e){var t="",n="",r="";return"#"===e.slice(0,1)?(t=e,r=S(n=M(e))):"rgb"===e.slice(0,3)?(n=e,t=k(e),r=S(e)):"hsl"===e.slice(0,3)&&(r=e,n=y(e),t=k(n)),{hex:{value:t},rgb:W(n),hsl:z(r)}}(a||x)),[a,x]),C=n((()=>N(b)),[b]),w=n((()=>function(e){const{h:t}=e.hsl;return t/360*100}(b)),[b]);function E(e){v(e),p(e)}const $=r(((e,t)=>{const{r:n,g:r,b:l}=b.rgb;switch(e){case"r":return void E(s(`rgb(${null!=t?t:0}, ${r}, ${l})`));case"g":return void E(s(`rgb(${n}, ${null!=t?t:0}, ${l})`));case"b":return void E(s(`rgb(${n}, ${r}, ${null!=t?t:0})`));default:return}}),[null==b?void 0:b.rgb]),R=r((e=>{const{width:t,height:n,left:r,top:l}=e.currentTarget.getBoundingClientRect(),o=H(e.clientX-r,0,t)/t*100,a=100-H(e.clientY-l,0,n)/n*100,i=function(e,t,n){const r=~~(e/60),l=e/60-r,o=(n/=100)*(1-(t/=100)),a=n*(1-t*l),i=n*(1-t*(1-l)),s=r%6;return`rgb(${Math.round(255*[n,a,o,o,i,n][s])}, ${Math.round(255*[i,n,n,a,o,o][s])}, ${Math.round(255*[o,o,i,n,n,a][s])})`}(null==b?void 0:b.hsl.h,o,a);E(s(i))}),[null==b?void 0:b.hsl.h]),j=r((e=>{const{width:t,left:n}=e.currentTarget.getBoundingClientRect(),r=H(e.clientX-n,0,t),l=`hsl(${Math.round(r/t*360)}, ${null==b?void 0:b.hsl.s}, ${null==b?void 0:b.hsl.l})`,o=u(l);E(s(o))}),[null==b?void 0:b.hsl.s,null==b?void 0:b.hsl.l]);return e.createElement(o,{sx:Object.assign({m:1,overflow:"auto",scrollbarWidth:"none",msOverflowStyle:"none","&::-webkit-scrollbar":{display:"none"}},g)},"predefined"===f?e.createElement(T,{colors:m,parsedColor:b,onSelect:p}):e.createElement(P,{parsedColor:b,satCoords:C,hueCoords:w,onSaturationChange:R,onHueChange:j}),e.createElement(d,{container:!0,spacing:1,justifyContent:"space-between"},e.createElement(d,{item:!0,container:!0,spacing:1,display:"flex",alignItems:"center",xs:12,md:6},e.createElement(d,{item:!0},e.createElement(i,{elevation:1,sx:{width:"25px",height:"25px",borderRadius:"50%",background:b.hex.value}})),e.createElement(d,{item:!0},e.createElement(c,{size:"small",label:"Hex",value:null==b?void 0:b.hex.value,onChange:e=>{var t=e.target.value;"#"!==(null==t?void 0:t.slice(0,1))&&(t="#"+t),E(t)},sx:{width:"95px"}}))),e.createElement(d,{item:!0,container:!0,spacing:1,display:"flex",justifyContent:"end",xs:12,md:6},e.createElement(d,{item:!0},e.createElement(c,{size:"small",label:"R",value:b.rgb.r,onChange:e=>$("r",e.target.value),sx:{width:"60px"},inputProps:{inputMode:"numeric",pattern:"[0-9]*"}})),e.createElement(d,{item:!0},e.createElement(c,{size:"small",label:"G",value:b.rgb.g,onChange:e=>$("g",e.target.value),sx:{width:"60px"},inputProps:{inputMode:"numeric",pattern:"[0-9]*"}})),e.createElement(d,{item:!0},e.createElement(c,{size:"small",label:"B",value:b.rgb.b,onChange:e=>$("b",e.target.value),sx:{width:"60px"},inputProps:{inputMode:"numeric",pattern:"[0-9]*"}})))))};j.defaultProps={initialColor:"#181d23",colors:R,onChange:e=>{},variant:"predefined",sx:{}};export{j as ColorPicker};
