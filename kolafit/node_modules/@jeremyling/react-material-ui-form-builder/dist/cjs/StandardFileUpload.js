"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./jsx-runtime-1efc2582.js"),t=require("lodash/get"),i=require("react"),r=require("react-hook-form"),n=require("@mui/material"),o=require("@mui/material/styles"),l=require("./ErrorText-af871538.js"),s=require("./Title-2c571786.js");function a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var u=a(t),d="image",c=function(){return c=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},c.apply(this,arguments)},p=[".pdf",".doc",".docx",".xml","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document",".xls",".xlsx",".csv","image/*","audio/*","video/*"];function x(e){return e.flatMap((function(e){return Array.isArray(e)?x(e):e}))}var f=o.styled("div")((function(e){var t,i,r=e.fieldConfig;return{display:"inline-block",position:"relative",width:(null===(t=r.imageSize)||void 0===t?void 0:t[0])||void 0,height:(null===(i=r.imageSize)||void 0===i?void 0:i[1])||void 0}})),m=o.styled("div")((function(e){var t,i,r,n,o=e.fieldConfig;return{marginTop:"".concat(Number((null===(t=o.imageSize)||void 0===t?void 0:t[1])||(null===(i=o.aspectRatio)||void 0===i?void 0:i[1])||1)/Number((null===(r=o.imageSize)||void 0===r?void 0:r[0])||(null===(n=o.aspectRatio)||void 0===n?void 0:n[0])||1)*100,"%")}})),v=o.styled("div")((function(){return{position:"absolute",top:0,bottom:0,right:0,left:0}})),g=o.styled("img")((function(){return{width:"100%",height:"100%",objectFit:"contain"}})),j=o.styled(n.Typography)((function(e){return{textAlign:"start",borderRadius:"4px",padding:"7px 10px",color:"rgba(0, 0, 0, 0.87)",overflow:"hidden",whiteSpace:"nowrap",margin:e.theme.spacing(1,0)}})),h=o.styled(n.ButtonBase)((function(){return{width:"100%",display:"block"}}));exports.default=function(t){var n=t.field,o=t.methods,a=o.control;o.getValues;var b=o.setValue,y=o.trigger,R=o.formState.errors,T=t.hideTitle,U=i.useState([]),w=U[0],z=U[1],S=i.useMemo((function(){return n.maxSizeMb||2}),[n.maxSizeMb]),q=i.useMemo((function(){return(e=n.acceptTypes)&&"string"==typeof e.valueOf()?n.acceptTypes:Array.isArray(n.acceptTypes)?x(n.acceptTypes).join(","):p.join(",");var e}),[n.acceptTypes]),C=function(e){if(!e||e.length<1)z(["Nothing selected"]);else{for(var t={files:[],imageUrls:[]},i=[],r=0,o=Array.from(e);r<o.length;r++){var l=o[r];if(l.size>1024*S*1024)i.push((l.name||"File")+" should be less than "+S+" MB");else if(t.files.push(l),n.fileType===d){var s=URL.createObjectURL(l);t.imageUrls.push(s)}}n.multiple||(t={files:[t.files[0]],imageUrls:[t.imageUrls[0]]}),b(n.attribute,t),z(i)}},M=function(e){return c({id:e.id||e.attribute,type:"file",hidden:!0,multiple:!1,accept:q,onChange:function(e){return C(e.target.files)}},e.props)};return e.jsxRuntime.exports.jsx(r.Controller,{name:n.attribute,control:a,render:function(t){var i,r,o,a,p,x=t.field;return e.jsxRuntime.exports.jsxs(e.jsxRuntime.exports.Fragment,{children:[!T&&n.title&&e.jsxRuntime.exports.jsx(s.Title,{field:n}),e.jsxRuntime.exports.jsx("input",c({},M(n))),e.jsxRuntime.exports.jsx("label",c({htmlFor:n.id||n.attribute,onBlur:function(){return y(n.attribute)}},{children:(null===(r=null===(i=x.value)||void 0===i?void 0:i.files)||void 0===r?void 0:r.length)>0?x.value.files.map((function(t,i){var r,o;return e.jsxRuntime.exports.jsxs(h,c({component:"div"},{children:[n.fileType===d&&(null===(r=x.value.imageUrls)||void 0===r?void 0:r.length)>0&&e.jsxRuntime.exports.jsxs(f,c({fieldConfig:n},{children:[e.jsxRuntime.exports.jsx(m,{fieldConfig:n}),e.jsxRuntime.exports.jsx(v,{children:e.jsxRuntime.exports.jsx(g,{src:null===(o=x.value.imageUrls)||void 0===o?void 0:o[i],alt:t.name,loading:"lazy"})})]})),e.jsxRuntime.exports.jsx(j,c({sx:{border:function(e){return"1px solid ".concat(u.default(R,n.attribute)?e.palette.error.main:"#b9b9b9")}}},{children:t.name||t}))]}),i)})):e.jsxRuntime.exports.jsxs(h,c({component:"div"},{children:[n.fileType===d&&(null===(o=n.imageUrls)||void 0===o?void 0:o[0])&&e.jsxRuntime.exports.jsxs(f,c({fieldConfig:n},{children:[e.jsxRuntime.exports.jsx(m,{fieldConfig:n}),e.jsxRuntime.exports.jsx(v,{children:e.jsxRuntime.exports.jsx(g,{src:n.imageUrls[0],alt:n.label,loading:"lazy"})})]})),e.jsxRuntime.exports.jsx(j,c({sx:{color:"#777777",border:function(e){return"1px solid ".concat(u.default(R,n.attribute)?e.palette.error.main:"#b9b9b9")}}},{children:(null===(a=n.imageUrls)||void 0===a?void 0:a[0])||n.label}))]}))})),!!u.default(R,n.attribute)&&e.jsxRuntime.exports.jsx(l.ErrorText,{error:null===(p=u.default(R,n.attribute))||void 0===p?void 0:p.message}),(null==w?void 0:w.length)>0&&e.jsxRuntime.exports.jsx(l.ErrorText,{error:w[0]})]})}})};
