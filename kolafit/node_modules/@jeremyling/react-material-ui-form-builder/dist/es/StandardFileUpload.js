import{j as e}from"./jsx-runtime-53cdfd8f.js";import i from"lodash/get";import{useState as r,useMemo as t}from"react";import{Controller as o}from"react-hook-form";import{Typography as n,ButtonBase as l}from"@mui/material";import{styled as a}from"@mui/material/styles";import{E as s}from"./ErrorText-a1dab7b9.js";import{T as d}from"./Title-61b3472c.js";var u="image",p=function(){return p=Object.assign||function(e){for(var i,r=1,t=arguments.length;r<t;r++)for(var o in i=arguments[r])Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o]);return e},p.apply(this,arguments)},c=[".pdf",".doc",".docx",".xml","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document",".xls",".xlsx",".csv","image/*","audio/*","video/*"];function f(e){return e.flatMap((function(e){return Array.isArray(e)?f(e):e}))}var m=a("div")((function(e){var i,r,t=e.fieldConfig;return{display:"inline-block",position:"relative",width:(null===(i=t.imageSize)||void 0===i?void 0:i[0])||void 0,height:(null===(r=t.imageSize)||void 0===r?void 0:r[1])||void 0}})),v=a("div")((function(e){var i,r,t,o,n=e.fieldConfig;return{marginTop:"".concat(Number((null===(i=n.imageSize)||void 0===i?void 0:i[1])||(null===(r=n.aspectRatio)||void 0===r?void 0:r[1])||1)/Number((null===(t=n.imageSize)||void 0===t?void 0:t[0])||(null===(o=n.aspectRatio)||void 0===o?void 0:o[0])||1)*100,"%")}})),x=a("div")((function(){return{position:"absolute",top:0,bottom:0,right:0,left:0}})),g=a("img")((function(){return{width:"100%",height:"100%",objectFit:"contain"}})),h=a(n)((function(e){return{textAlign:"start",borderRadius:"4px",padding:"7px 10px",color:"rgba(0, 0, 0, 0.87)",overflow:"hidden",whiteSpace:"nowrap",margin:e.theme.spacing(1,0)}})),b=a(l)((function(){return{width:"100%",display:"block"}}));function j(n){var l=n.field,a=n.methods,j=a.control;a.getValues;var y=a.setValue,T=a.trigger,U=a.formState.errors,w=n.hideTitle,z=r([]),S=z[0],C=z[1],A=t((function(){return l.maxSizeMb||2}),[l.maxSizeMb]),O=t((function(){return(e=l.acceptTypes)&&"string"==typeof e.valueOf()?l.acceptTypes:Array.isArray(l.acceptTypes)?f(l.acceptTypes).join(","):c.join(",");var e}),[l.acceptTypes]),R=function(e){if(!e||e.length<1)C(["Nothing selected"]);else{for(var i={files:[],imageUrls:[]},r=[],t=0,o=Array.from(e);t<o.length;t++){var n=o[t];if(n.size>1024*A*1024)r.push((n.name||"File")+" should be less than "+A+" MB");else if(i.files.push(n),l.fileType===u){var a=URL.createObjectURL(n);i.imageUrls.push(a)}}l.multiple||(i={files:[i.files[0]],imageUrls:[i.imageUrls[0]]}),y(l.attribute,i),C(r)}},F=function(e){return p({id:e.id||e.attribute,type:"file",hidden:!0,multiple:!1,accept:O,onChange:function(e){return R(e.target.files)}},e.props)};return e.exports.jsx(o,{name:l.attribute,control:j,render:function(r){var t,o,n,a,c,f=r.field;return e.exports.jsxs(e.exports.Fragment,{children:[!w&&l.title&&e.exports.jsx(d,{field:l}),e.exports.jsx("input",p({},F(l))),e.exports.jsx("label",p({htmlFor:l.id||l.attribute,onBlur:function(){return T(l.attribute)}},{children:(null===(o=null===(t=f.value)||void 0===t?void 0:t.files)||void 0===o?void 0:o.length)>0?f.value.files.map((function(r,t){var o,n;return e.exports.jsxs(b,p({component:"div"},{children:[l.fileType===u&&(null===(o=f.value.imageUrls)||void 0===o?void 0:o.length)>0&&e.exports.jsxs(m,p({fieldConfig:l},{children:[e.exports.jsx(v,{fieldConfig:l}),e.exports.jsx(x,{children:e.exports.jsx(g,{src:null===(n=f.value.imageUrls)||void 0===n?void 0:n[t],alt:r.name,loading:"lazy"})})]})),e.exports.jsx(h,p({sx:{border:function(e){return"1px solid ".concat(i(U,l.attribute)?e.palette.error.main:"#b9b9b9")}}},{children:r.name||r}))]}),t)})):e.exports.jsxs(b,p({component:"div"},{children:[l.fileType===u&&(null===(n=l.imageUrls)||void 0===n?void 0:n[0])&&e.exports.jsxs(m,p({fieldConfig:l},{children:[e.exports.jsx(v,{fieldConfig:l}),e.exports.jsx(x,{children:e.exports.jsx(g,{src:l.imageUrls[0],alt:l.label,loading:"lazy"})})]})),e.exports.jsx(h,p({sx:{color:"#777777",border:function(e){return"1px solid ".concat(i(U,l.attribute)?e.palette.error.main:"#b9b9b9")}}},{children:(null===(a=l.imageUrls)||void 0===a?void 0:a[0])||l.label}))]}))})),!!i(U,l.attribute)&&e.exports.jsx(s,{error:null===(c=i(U,l.attribute))||void 0===c?void 0:c.message}),(null==S?void 0:S.length)>0&&e.exports.jsx(s,{error:S[0]})]})}})}export{j as default};
